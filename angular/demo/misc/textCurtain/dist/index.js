angular.module("textCurtain-0.1.0",[]).directive("textCurtain",[function(){return{compile:function(element,attrs){var cMaxHeight,bodyTopPosition,elTopPosition,defaultTx=angular.isDefined(attrs.curtainText)?attrs.curtainText:"show more",defaultTxHide=angular.isDefined(attrs.curtainTextHide)?attrs.curtainTextHide:"hide",minHeight=angular.isDefined(attrs.curtainMinHeight)?parseInt(attrs.curtainMinHeight,10):null,hideFalse=angular.isDefined(attrs.curtainHideFalse)?!0:!1,cHeight=angular.isDefined(attrs.curtainHeight)?attrs.curtainHeight:"100px",minNumChars=angular.isDefined(attrs.curtainMinChars)?attrs.curtainMinChars:0,button=$('<div class="show-more-desc"><span><a>'+defaultTx+"</a></span></div>"),bottomGradient=$('<div class="bottom-grad"></div>');element.ready(function(){return cMaxHeight=element.height(),minHeight&&cMaxHeight>minHeight||element.text().length>minNumChars?(element.addClass("short-desc"),element.css({height:cHeight,overflow:"hidden"}),element.prepend(bottomGradient),button.find("a").click(function(e){"hidden"==element.css("overflow")?element.animate({height:cMaxHeight+20},600,function(){element.css({overflow:"visible"}),element.find(".bottom-grad").remove(),$(e.target).text(defaultTxHide),hideFalse&&element.next(".show-more-desc").remove()}):(element.prepend(bottomGradient),bodyTopPosition=-1*$("html, body").offset().top,elTopPosition=element.offset().top,bodyTopPosition>elTopPosition&&$("html, body").animate({scrollTop:elTopPosition-20},"slow"),element.animate({height:cHeight},600,function(){element.css({overflow:"hidden"}),$(e.target).text(defaultTx)}))}),element.after(button),!0):void 0})}}}]);